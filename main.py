from exploit_api.main import gyat
import os
import ctypes
import requests
import win32gui
import time
from datetime import datetime
from exploit_api.titties.auto_dumper.offset_dumper import main as dump

main_dir = os.path.dirname(os.path.abspath(__file__))
autoexec_path = os.path.join(main_dir, "autoexec")

global proto
proto = gyat()
proto.SetAutoExecPath(autoexec_path)

errors = {
    0x0: "Successfully injected!",
    0x1: "Currently injecting!",
    0x2: "Failed to find Roblox process.",
    0x3: "Failed to fetch DataModel :(",
    0x4: "Failed to fetch certain modules.",
    0x5: "Roblox terminated while injecting!",
    0x6: "Failed to find Bridge!"
}

if __name__ == "__main__":
    os.system("title Compiled Works")
    os.system("@echo off")
    os.system("cls")
    print("Press Enter to inject...")
    input()
    print("[*] Finding Roblox process...")
    if win32gui.FindWindow(None, "Roblox"):
        print("[-] Found Roblox!")
        start_time = datetime.now()
        print("[*] Injecting modules...")
        print("[-] Injected Modules!")
        end_time = datetime.now()
        elapsed_time = (end_time - start_time).total_seconds()
        print(f"Injected at {elapsed_time:.3f} seconds.")
        print("Join a game!")
        compiled = proto.Inject()
        print(errors.get(compiled, "Unknown error"))
    else:
        print("No Roblox found :c")
        exit(0)
